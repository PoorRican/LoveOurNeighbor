{# TODO: display name and profile pic. Enable editing #}
{# TODO: total donated amount #}
{# TODO: campaigns involved in #}

<section class="wrapper">
  {% if start %}
    <h1>New Ministry Profile:</h1>
    <!-- TODO: make link for more information -->
    <h3>Please note that all ministry profiles are must be approved before they are made public</h3>

    <form method="POST" enctype="multipart/form-data" action="{{ url_for('ministry:create_ministry') }}">

  {% else %}
    <h1>

      Edit Ministry Profile:&nbsp;

      <a href="#{{ url_for('ministry:ministry_profile', kwargs={'ministry_id': ministry.id}) }}"
       style="text-decoration: none;">
        <md-button class="md-raised md-primary">
          View
        </md-button>
      </a>

    </h1>

    <form method="POST" enctype="multipart/form-data" action="{{ url_for('ministry:edit_ministry', kwargs={'ministry_id': ministry.id}) }}">
      <input type="hidden" id="current_object_json" value="{{ url_for("ministry:ministry_json", kwargs={'ministry_id': ministry.id}) }}">

  {% endif %}

    <input type="hidden" enctype="multipart/form-data" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

    <div layout="column" layout-padding class="md-inline-form">
      <h3>
        <md-icon>
          <i class="material-icons">info</i>
        </md-icon>&nbsp;
        Ministry Details:
      </h3>
      <md-input-container>
        {# TODO: ensure that all ministry titles are unique #}
        {{ form.name.label_tag() }}
        <md-icon><i class="material-icons">group</i></md-icon>
        {{ form.name }}
      </md-input-container>
      <md-input-container>
        {{ form.address.label_tag() }}
        {# TODO: render custom address input #}
        <md-icon><i class="material-icons">place</i></md-icon>
        {{ form.address }}
      </md-input-container>

      <div layout-gt-sm="row" layout-padding>
        <md-input-container flex-gt-sm="50">
          {{ form.phone_number.label_tag() }}
          {# TODO: render styled phone number input for international phone numbers #}
          <md-icon><i class="material-icons">phone</i></md-icon>
          {{ form.phone_number }}
        </md-input-container>
        <md-input-container flex-gt-sm="50">
          {{ form.website.label_tag() }}
          <md-icon><i class="material-icons">explore</i></md-icon>
          {{ form.website }}
        </md-input-container>
      </div>
      <div layout="row">
        <h5 style="font-weight: 400">
          {{ form.founded.label }}:
        </h5>
        <input type="hidden" name="{{ form.founded.name }}" value="{% raw %}{{ object.founded | date:'yyyy-MM-dd' }}{% endraw %}">
        <md-input-container>
          <md-icon><i class="material-icons">cake</i></md-icon>
          <md-datepicker md-hide-icons="calendar" id="{{ form.founded.id_for_label }}" ng-model="object.founded" md-placeholder="Enter date founded" md-open-on-focus hide-sm hide-xs></md-datepicker>
          <div class="hint">When did this ministry start?</div>
          <input type="date" ng-model="object.founded" hide-gt-sm>
        </md-input-container>
      </div>
      <br>

      <md-divider></md-divider>

      <h3>
        <md-icon>
          <i class="material-icons">description</i>
        </md-icon>&nbsp;
        Profile Content:
      </h3>
      <md-input-container>
        {# TODO: render WYSIWYG editor #}
        <md-icon><i class="material-icons">subject</i></md-icon>
        {{ form.description.label_tag() }}
        {{ form.description }}
        <div class="hint">Describe yourself</div>
      </md-input-container>
      {# TODO: show custom file selector displaying previous images #}
      <div layout-gt-sm="row" layout-padding>
        <md-icon style="margin: 0"><i class="material-icons">image</i></md-icon>
        {{ form.img_path.label_tag() }}
        {{ form.img_path }}
      </div>

      <md-divider></md-divider>

      <h3>
        <md-icon>
          <i class="material-icons">lock</i>
        </md-icon>&nbsp;
        Administration:
      </h3>
      <md-input-container>
        <div layout-gt-sm="row" layout-padding>
          <h5>
            <md-icon><i class="material-icons">group_add</i></md-icon>
            {{ form.reps.label }}:
          </h5>
        {{ form.reps }}
        </div>
      </md-input-container>

      <div id="form_buttons" layout="row">
        <md-button style="position: fixed; bottom: 75; right: 10%;" class="md-fab md-primary" type="submit">
          <md-icon>
            <i class="material-icons">save</i>
          </md-icon>
        </md-button>

        {% if not start and ministry %}
          <md-button class="md-icon-button md-raised md-warn">
            <a style="color: #FFF; text-decoration: none;" href="{{ url_for('ministry:delete_ministry', kwargs={'ministry_id': ministry.id}) }}">
              <md-icon>
                <i class="material-icons">delete</i>
              </md-icon>
            </a>
            {# TODO: implement DOUBLE dialog confirmation #}
          </md-button>
        {% endif %}
      </div><!-- /#form_buttons -->

    </div><!-- /.md-inline-form -->

  </form>


  {% if not start %}

    <a href="#{{ url_for('ministry:create_news', kwargs={'obj_type': 'ministry', 'obj_id': ministry.id}) }}"
     style="text-decoration: none;">
      <md-button class="md-raised md-accent">
        Create News&nbsp;
        <md-icon>
          <i class="material-icons">note_add</i>
        </md-icon>
      </md-button>
    </a>

    {# TODO: differentiate between current and previous fundraisers #}
    <h1>Campaigns:</h1>
    <a href="#{{ url_for('ministry:create_campaign', kwargs={'ministry_id': ministry.id}) }}">
      Create a new fundraiser
    </a>

    <ul>
      {% for i in ministry.campaigns.all() %}
        <li>
          <a href="#{{ url_for('ministry:campaign_detail', kwargs={'campaign_id': i.id}) }}">
            {{ i }}
          </a>
        </li>
      {% endfor %}
    </ul>

  {% endif %}

</section>

