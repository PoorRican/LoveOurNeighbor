{# vim: foldmethod=marker tabstop=2 shiftwidth=2:
    templates/ministry/news_content.html
#}
{% import "parts.html" as parts %}

<section class="wrapper">
  <!-- ministry/news_content -->

  {% if start %}
    <h1>Create News Post:</h1>
    <!-- TODO: make link for more information -->

    <form method="POST" action="{{ url_for('ministry:create_news', kwargs=kwargs) }}">

  {% else %}
    <h1>Edit Ministry Profile:</h1>

    <form enctype="multipart/form-data" method="POST" action="{{ url_for('ministry:edit_news', kwargs={'post_id': post.id}) }}">

  {% endif %}

    <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

    <div layout="column" layout-padding class="md-inline-form">
      {{ form.attachment.label_tag() }}
      {{ form.attachment }}

      <md-input-container>
        {# TODO: ensure that all ministry titles are unique #}
        {{ form.title.label_tag() }}
        {{ form.title }}
      </md-input-container>

      <md-input-container>
        {# TODO: render WYSIWYG editor #}
        {{ form.content.label_tag() }}

        {% if start %}
          {{ parts.wysiwyg_editor(form.content.name) }}
        {% else %}
          {{ parts.wysiwyg_editor(form.content.name, 'news_editor', value=post.content) }}
        {% endif %}

      </md-input-container>

      <div id="form_buttons" layout-align-gt-sm="end" layout-gt-sm="row" layout="column">
        {# TODO: implement DOUBLE dialog confirmation upon deletion #}
        <md-button class="md-raised md-primary" type="submit" flex-gt-sm="25">
          <md-icon>
            <i class="material-icons">save</i>
          </md-icon>
          Save
        </md-button>

        {% if not start and post %}
          <br>
          <md-button class="md-warn" style="text-decoration: none;"
                     href="{{ url_for('ministry:delete_news', kwargs={'post_id': post.id}) }}"
                     flex-order-gt-sm="-1">
            <md-icon>
              <i class="material-icons">delete</i>
            </md-icon>
            Delete
          </md-button>
        {% endif %}
      </div><!-- /#form_buttons -->

    </div>

  </form>

</section>


<!-- Google Analytics Virtual Pageview -->
<script>ga('send', 'pageview', 'news post edit')</script>
