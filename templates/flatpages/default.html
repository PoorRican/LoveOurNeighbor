{# vim: foldmethod=marker ft=jinja shiftwidth=2 tabstop=2:

    templates/layout.html

#}

{% from "macros/layout/navbar_links.html" import navbar_links %}
{% from "macros/layout/searchbar.html" import searchbar %}
{% from "macros/layout/sidenav.html" import sidenav %}
{% from "macros/layout/footer.html" import footer %}


<!DOCTYPE html>
<html lang="en">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="{{ ', '.join(keywords) }}">


{% block metadata %}
  <!-- Facebook OpenGraph meta properties -->
  <meta property="og:type" content="website"/>
  <meta property="og:image" content="{{ static('img/favicon.png') }}">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="51">
  <meta property="og:image:height" content="59">
{% endblock %}


<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-153638464-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'UA-153638464-1');
  </script>


  <title>{{ flatpage.title }} - Love Our Neighbor</title>

  {# favicon #}
  <link rel="shortcut icon" href="{{ static('img/favicon.svg') }}">
  <link rel="apple-touch-icon" href="{{ static('img/favicon.svg') }}">

  {# {{{ CSS Imports #}
  <link rel="stylesheet" href="{{ static('theme/vendors.min.css') }}">
  <link rel="stylesheet" href="{{ static('theme/materialize.min.css') }}">
  <link rel="stylesheet" href="{{ static('theme/style.min.css') }}">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  {% block css %}{% endblock %}

  {# Local Scripts #}
  {# TODO: fetch these from CDN while on production #}
  {% assets "css" %}
    <link rel="stylesheet" href="/{{ ASSET_URL }}">
  {% endassets %}

  {# }}} #}

</head>

<body
    class="vertical-layout vertical-menu-collapsible page-header-dark vertical-modern-menu 2-columns menu-expanded fixed-navbar"
    data-open="click" data-menu="vertical-modern-menu" data-color="" data-col="2-columns">

{% if not active %}
  {% set active = flatpage.url %}
{% endif %}

<header class="page-topbar" id="header">
  {% set links =
    [
      (url_for('home'), 'Home', 'fa fa-home'),
      (url_for('faq'), 'FAQ', 'fa fa-question-circle-o'),
    ] %}
  <div class="navbar navbar-fixed">
    {{ navbar_links(request) }}
  </div>
</header>

<main id="main">
  <div class="wrapper">
    {{ flatpage.content }}
  </div>
</main>

{% set _links = links.copy() %}
<!-- {{ _links.append({'title': 'About Us', 'fa-icon': 'fa fa-compass',
                             'links': get_flatpages()}) }} -->
{{ sidenav(request, _links, active) }}

{{ footer(links+get_flatpages()) }}

{# paths must be relative to static directory #}
{% set layout_assets = (
    'js/ui-feedback.animations.js',
    'js/vendors.min.js',
    'js/materialize.js',
    'js/plugins.js',
    'js/search.js',
  ) %}
{% for f in layout_assets %}
  <script src="{{ static('%s' % f) }}"></script>
{% endfor %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    let options = {};
    // Initialize Sidebar Component
    let el = document.querySelectorAll('.sidenav');
    M.Sidenav.init(el);

    // Initialize Dropdown Components
    el = document.querySelectorAll('.dropdown-trigger');
    M.Dropdown.init(el);

    // Initialize Collapsible Components
    el = document.querySelectorAll('.sidenav-accordian');
    M.Collapsible.init(el, {
      onOpenStart: open_collapsible,
      onCloseStart: close_collapsible
    });
    el = document.querySelectorAll('.collapsible');
    M.Collapsible.init(el);

    // Initialize Datepicker components
    el = document.querySelectorAll('.datepicker');
    options = {format: 'mm/dd/yyyy'};
    M.Datepicker.init(el, options);

    el = document.querySelectorAll('.modal');
    M.Modal.init(el);

    // Initialize Tab Components
    el = document.querySelectorAll('.tabs');
    M.Tabs.init(el);

    // Parallax Banner Images
    el = document.querySelectorAll('.parallax');
    M.Parallax.init(el);

    // Image Viewer
    el = document.querySelectorAll('.materialboxed');
    M.Materialbox.init(el);

    el = document.querySelectorAll('.tooltipped');
    M.Tooltip.init(el)

  });

</script>

{% block scripts %}{% endblock %}


{# }}} #}

</body>
</html>
